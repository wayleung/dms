<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>宿舍管理系统</title>

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="font-awesome/css/font-awesome.css" rel="stylesheet">



<link href="css/animate.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<link href="lib/datepicker3.css" rel="stylesheet">


<style>
.nav>li.active {
	border-left: 4px solid #d31145;
	background: #293846;
}

.pg-input {
	float: left;
	height: 28px;
	width: 60px;
	font-size: 14px;
	background-color: #FFFFFF;
	background-image: none;
	border: 1px solid #e5e6e7;
	padding-left: 20px;
	margin-left: 20px;
}

.pg-go-btn {
	height: 28px;
	border-radius: 0px;
}

.font16 {
	font-size: 16px;
}

.green {
	color: #18a689;
}
</style>

</head>

<body>
	<div id="wrapper">
		<include src="nav.html"></include>

		<div id="page-wrapper" class="gray-bg dashbard-1">
			<include src="headbar.html"></include>

			<div class="row">

				<div class="col-lg-12">
					<div class="row wrapper border-bottom white-bg page-heading">
						<div class="col-lg-10">
							<h2>宿舍管理人员管理</h2>
							<ol class="breadcrumb">
								<li><a href="index.html">首页</a></li>
								<li class="active"><strong>宿舍管理人员管理</strong></li>
							</ol>
						</div>
						<div class="col-lg-2"></div>
					</div>
					<div class="wrapper wrapper-content animated fadeInRight">
						<div class="row">

							<div class="col-lg-12">
								<div class="ibox float-e-margins">
									<div class="ibox-title">
										<h5>所有宿舍管理人员</h5>
										<div class="ibox-tools">
											<a class=""> <i class="fa fa-search green font16"></i>
											</a> <a class="collapse-link"> <i
												class="fa fa-chevron-up  font16"></i>
											</a>
										</div>
										<!-- <span class="label label-primary pull-right">NEW<i class="fa fa-plus"></i></span>
                            <button type="button" class="btn btn-md btn-primary"><i class="fa fa-plus"></i></button> -->
									</div>

									<div class="ibox-content" style="display: block;">
										<div class="row">
											<div class="col-sm-3">
												<div class="input-group pull-right">
													<span class="input-group-btn">
														<button type="button" class="btn btn-sm btn-primary"
															data-toggle="modal" data-target="#addModal">
															<i class="fa fa-plus"></i>增加
														</button>
													</span>
												</div>
											</div>
										</div>
										<div class="table-responsive">
											<div class="sk-spinner sk-spinner-fading-circle"
												style="display: none">
												<div class="sk-circle1 sk-circle"></div>
												<div class="sk-circle2 sk-circle"></div>
												<div class="sk-circle3 sk-circle"></div>
												<div class="sk-circle4 sk-circle"></div>
												<div class="sk-circle5 sk-circle"></div>
												<div class="sk-circle6 sk-circle"></div>
												<div class="sk-circle7 sk-circle"></div>
												<div class="sk-circle8 sk-circle"></div>
												<div class="sk-circle9 sk-circle"></div>
												<div class="sk-circle10 sk-circle"></div>
												<div class="sk-circle11 sk-circle"></div>
												<div class="sk-circle12 sk-circle"></div>
											</div>


											<table class="table table-striped">
												<thead>
													<tr>
														<th>工号</th>
														<th>姓名</th>
														<th>生日</th>
														<th>性别</th>
														<th>电话</th>
														<th>备注</th>
														<th>操作</th>
													</tr>
												</thead>
												<tbody id="result">
													
												</tbody>
											</table>
											<!-- <div class="pull-right">
												<ul class="pagination">
													<li><a href="#">上一页</a></li>
													<li><a href="#">1</a></li>
													<li><a href="#">/</a></li>
													<li><a href="#">3</a></li>
													<li><a href="#">下一页</a></li>

													<li><input type="text" class="pg-input">
													<li>
													<li><button type="button"
															class="btn btn-sm btn-primary pg-go-btn">转到</button></li>
												</ul>
											</div> -->
										</div>

									</div>
								</div>
							</div>

						</div>
					</div>

					<include src="footer.html"></include>
				</div>
			</div>

		</div>

	</div>

	<div class="modal inmodal" id="addModal" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated bounceInRight">
				<!-- <button type="button" class="close" data-dismiss="modal">
					<span aria-hidden="true">Ã</span><span class="sr-only">Close</span>
				</button> -->
				<div class="row">
					<div class="col-lg-12">
						<button type="button" class="close" data-dismiss="modal">
							<!-- <span aria-hidden="true">x</span><span class="sr-only">Close</span> -->
						</button>
						<div class="ibox float-e-margins">
							<div class="ibox-content">
								<form id="add_form" method="post" class="form-horizontal">
									<div class="form-group">
										<label class="col-sm-2 control-label">工号</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="dmNum" name="dmNum">
										</div>
									</div>
									
									<div class="form-group">
										<label class="col-sm-2 control-label">密码</label>

                                    	<div class="col-sm-10">
											<input type="password" class="form-control"
												id="password" name="password">
										</div>
									</div>
									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">姓名</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="name" name="name">
										</div>
									</div>
									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">生日</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="birthDate" name="birthDate">
										</div>
									</div>
									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">性别</label>

										<div class="col-sm-10">
											<select class="form-control" id="sex" name="sex">
                                        	<option value="男">男</option>
                                        	<option value="女">女</option>
                                    		</select>
										</div>
									</div>
									
									

									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">电话</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="phone" name="phone">
										</div>
									</div>
									


<!-- 									
									<div class="form-group" id="data_2">
										<label class="col-sm-2 control-label">创建时间</label>

										<div class="col-sm-10">
											<div class="input-group date">
												<span class="input-group-addon"><i
													class="fa fa-calendar"></i></span><input type="text"
													class="form-control" id="createTime" name="createTime">
											</div>
										</div>
									</div>
									 -->
									


																											




									<div class="form-group">
										<label class="col-sm-2 control-label">备注</label>

										<div class="col-sm-10">
											<input type="text" class="form-control"
												id="remark" name="remark">
										</div>
									</div>



									<div class="hr-line-dashed"></div>
									<div class="form-group">
									<div class="col-sm-1 col-sm-offset-1"></div>
										<div class="col-sm-6 col-sm-offset-2">
											<button class="btn btn-white" type="button"
												data-dismiss="modal">取消</button>
											<button class="btn btn-primary" type="button"
												onclick="insertDormManager()">保存</button>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="modal inmodal" id="updateModal" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated bounceInRight">

				<div class="row">
					<div class="col-lg-12">
 						<button type="button" class="close" data-dismiss="modal">
<!-- 							<span aria-hidden="true">x</span><span class="sr-only">Close</span> -->
						</button>
						<div class="ibox float-e-margins">
							<div class="ibox-content">
								<form id="update_form" method="post" class="form-horizontal">
									<input type="hidden" id="id_update" name="id_update">

									<div class="form-group">
										<label class="col-sm-2 control-label">工号</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="dmNum_update" name="dmNum_update">
										</div>
									</div>
									
									<div class="form-group">
										<label class="col-sm-2 control-label">密码</label>

                                    	<div class="col-sm-10">
											<input type="password" class="form-control"
												id="password_update" name="password_update">
										</div>
									</div>
									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">姓名</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="name_update" name="name_update">
										</div>
									</div>
									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">生日</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="birthDate_update" name="birthDate_update">
										</div>
									</div>
									
									
									<div class="form-group">
										<label class="col-sm-2 control-label">性别</label>

										<div class="col-sm-10">
											<select class="form-control" id="sex_update" name="sex_update">
                                        	<option value="男">男</option>
                                        	<option value="女">女</option>
                                    		</select>
										</div>
									</div>
									
									

									

									
									<div class="form-group">
										<label class="col-sm-2 control-label">电话</label>

                                    	<div class="col-sm-10">
											<input type="text" class="form-control"
												id="phone_update" name="phone_update">
										</div>
									</div>
									

									

<!-- 									
									<div class="form-group" id="data_2">
										<label class="col-sm-2 control-label">创建时间</label>

										<div class="col-sm-10">
											<div class="input-group date">
												<span class="input-group-addon"><i
													class="fa fa-calendar"></i></span><input type="text"
													class="form-control" id="createTime" name="createTime">
											</div>
										</div>
									</div>
									 -->
									

																											


									


									<div class="form-group">
										<label class="col-sm-2 control-label">备注</label>

										<div class="col-sm-10">
											<input type="text" class="form-control"
												id="remark_update" name="remark_update">
										</div>
									</div>
									
									
									
									<div class="hr-line-dashed"></div>
									<div class="form-group">
									<div class="col-sm-1 col-sm-offset-1"></div>
										<div class="col-sm-6 col-sm-offset-2">
											<button class="btn btn-white" type="button"
												data-dismiss="modal">取消</button>
											<button class="btn btn-primary" type="button"
												onclick="updateDormManager()">保存更新</button>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!-- Mainly scripts -->
	<script src="js/jquery-2.1.1.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
	<script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

	<!-- Custom and plugin javascript -->
	<script src="js/inspinia.js"></script>
	<script src="js/plugins/pace/pace.min.js"></script>
	<script src="lib/bootstrap-datepicker.js"></script>

	<script type="text/javascript">
		$('#data_1 .input-group.date').datepicker({
			todayBtn : "linked",
			keyboardNavigation : false,
			forceParse : false,
			calendarWeeks : true,
			autoclose : true
		});

		$('#data_2 .input-group.date').datepicker({
			todayBtn : "linked",
			keyboardNavigation : false,
			forceParse : false,
			calendarWeeks : true,
			autoclose : true
		});

		$('#data_3 .input-group.date').datepicker({
			todayBtn : "linked",
			keyboardNavigation : false,
			forceParse : false,
			calendarWeeks : true,
			autoclose : true
		});

		$('#data_4 .input-group.date').datepicker({
			todayBtn : "linked",
			keyboardNavigation : false,
			forceParse : false,
			calendarWeeks : true,
			autoclose : true
		});

		function getHostPath() {
			var curWwwPath = window.document.location.href;
			var pathName = window.document.location.pathname;
			var pos = curWwwPath.indexOf(pathName);
			//获取主机地址，如： http://localhost:8083
			var localhostPath = curWwwPath.substring(0, pos);
			return localhostPath;
		}

		var rootPath = getHostPath() + "/" + "dms/";
		/* 			  $(document).ready(function(){
		 console.log(rootPath); 
		 }); */

		function insertDormManager() {
			var url = rootPath + "insertDormManager";

			var dmNum = $("#dmNum").val();
			var password = $("#password").val();
			var name = $("#name").val();
			var birthDate = $("#birthDate").val();
			var sex = $("#sex").val();
			var phone = $("#phone").val();
			var remark = $("#remark").val();
		
			

				if (dmNum != null && dmNum != ""
					/* && password != null && password != ""
					&& name != null && name != ""
					&& birthDate != null && birthDate != ""
					&& sex != null && sex != ""
					&& phone != null && phone != "" */) {
				var json = {
					"dmNum" : dmNum,
					"password" : password,
					"name" : name,
					"birthDate" : birthDate,
					"sex" : sex,
					"phone" : phone,
					"remark" : remark
				};

				console.log(+url);
				$.ajax({
					url : url,
					type : "post",
					async : true,
					data : json,
				});
			}

			window.location.reload();
		}

		function fillUpdateForm(id, dmNum, password, name, birthDate,sex,phone,remark) {
			$("#id_update").val(id);
			$("#dmNum_update").val(dmNum);
			$("#password_update").val(password);
			$("#name_update").val(name);
			$("#birthDate_update").val(birthDate);
			$("#sex_update").val(sex);
			
			$("#phone_update").val(phone);
			
			$("#remark_update").val(remark);
		}

		function updateDormManager() {
			var url = rootPath + "updateDormManager";
			
			
			var id = $("#id_update").val();
			var dmNum = $("#dmNum_update").val();
			var password = $("#password_update").val();
			var name = $("#name_update").val();
			var birthDate = $("#birthDate_update").val();
			var sex = $("#sex_update").val();
			var phone = $("#phone_update").val();
			var remark = $("#remark_update").val();
		
			

				if (id != null && id != ""
					&& dmNum != null && dmNum != ""
					/* && password != null && password != ""
					&& name != null && name != ""
					&& birthDate != null && birthDate != ""
					&& sex != null && sex != ""
					&& phone != null && phone != ""
				*/) {
				var json = {
					"id_update" : id,
					"dmNum_update" : dmNum,
					"password_update" : password,
					"name_update" : name,
					"birthDate_update" : birthDate,
					"sex_update" : sex,
					"phone_update" : phone,
					"remark_update" : remark
				};

				console.log(url);
				$.ajax({
					url : url,
					type : "post",
					async : true,
					data : json,
				});
			}
				window.location.reload();
		}

		function deleteDormManagerById(id) {
			var url = rootPath + "deleteDormManager";
			var json = {
				"id" : id,
			};

			console.log(url);
			$.ajax({
				url : url,
				type : "post",
				async : true,
				data : json,
			});
			window.location.reload();
		}


		//function ajax(api,datas) {
		$(document)
				.ready(
						function() {
							var url = rootPath + "queryAllDormManagers";
							console.log(url);
							$
									.ajax({
										url : url,
										type : "post",
										async : true,
										dataType : "json",
										//data: datas,
										//异步   注意数据的获取
										success : function(map_json) {
											//alert(map_json);
											var list_json = map_json.dormManagerList;
											var ul;
											$
													.each(
															list_json,
															function(i, n) {
																//获取对象中属性为optionsValue的值 
																	ul += "<tr>"
																		+ "<td>"
																		+ list_json[i].dmNum
																		+ "</td>"
																		+ "<td>"
																		+ list_json[i].name
																		+ "</td>"
																		+ "<td>"
																		+ list_json[i].birthDate
																		+ "</td>"
																		+ "<td>"
																		+ list_json[i].sex
																		+ "</td>"
																		
																		
																		+ "<td>"
																		+ list_json[i].phone
																		+ "</td>"
																		
																		
																		
																		+ "<td>"
																		+ list_json[i].remark
																		+ "</td>"
																		+ "<td><a href='#' data-toggle='modal' data-target='#updateModal' onclick='fillUpdateForm(\""
																		+ list_json[i].dmId
																		+ "\",\""
																		+ list_json[i].dmNum
																		+ "\",\""
																		+ list_json[i].password
																		+ "\",\""
																		+ list_json[i].name
																		+ "\",\""
																		+ list_json[i].birthDate
																		+ "\",\""
																		+ list_json[i].sex
																		+ "\",\""
																		
																		+ list_json[i].phone
																		+ "\",\""
																		
																		+ list_json[i].remark
																		+ "\")'>更新</a>&nbsp;&nbsp;&nbsp;<a href='#' onclick='deleteDormManagerById("
																		+ list_json[i].dmId
																		+ ")'>删除</a></td>"
																		+ "</tr>";
																
																
															});
											//ul+="</ul>"; 
											$('#result').append(ul);
										}
									});
						});
		//}
		
		
		
		
		
		/** 
		 * include页面方法
		 */  
		(function(window, document, undefined) {  
		    var Include39485748323 = function() {}  
		    Include39485748323.prototype = {  
		        //倒序循环  
		        forEach: function(array, callback) {  
		            var size = array.length;  
		            for(var i = size - 1; i >= 0; i--){  
		                callback.apply(array[i], [i]);  
		            }  
		        },  
		        getFilePath: function() {  
		            var curWwwPath=window.document.location.href;  
		            var pathName=window.document.location.pathname;  
		            var localhostPaht=curWwwPath.substring(0,curWwwPath.indexOf(pathName));  
		            var projectName=pathName.substring(0,pathName.substr(1).lastIndexOf('/')+1);  
		            return localhostPaht+projectName;  
		        },  
		        //获取文件内容  
		        getFileContent: function(url) {  
		            var ie = navigator.userAgent.indexOf('MSIE') > 0;  
		            var o = ie ? new ActiveXObject('Microsoft.XMLHTTP') : new XMLHttpRequest();  
		            o.open('get', url, false);  
		            o.send(null);  
		            return o.responseText;  
		        },  
		        parseNode: function(content) {  
		            var objE = document.createElement("div");  
		            objE.innerHTML = content;  
		            return objE.childNodes;  
		        },  
		        executeScript: function(content) {  
		            var mac = /<script>([\s\S]*?)<\/script>/g;  
		            var r = "";  
		            while(r = mac.exec(content)) {  
		                eval(r[1]);  
		            }  
		        },  
		        getHtml: function(content) {  
		            var mac = /<script>([\s\S]*?)<\/script>/g;  
		            content.replace(mac, "");  
		            return content;  
		        },  
		        getPrevCount: function(src) {  
		            var mac = /\.\.\//g;  
		            var count = 0;  
		            while(mac.exec(src)) {  
		                count++;  
		            }  
		            return count;  
		        },  
		        getRequestUrl: function(filePath, src) {  
		            if(/http:\/\//g.test(src)){ return src; }  
		            var prevCount = this.getPrevCount(src);  
		            while(prevCount--) {  
		                filePath = filePath.substring(0,filePath.substr(1).lastIndexOf('/')+1);  
		            }  
		            return filePath + "/"+src.replace(/\.\.\//g, "");  
		        },  
		        replaceIncludeElements: function() {  
		            var $this = this;  
		            var filePath = $this.getFilePath();  
		            var includeTals = document.getElementsByTagName("include");  
		            this.forEach(includeTals, function() {  
		                //拿到路径  
		                var src = this.getAttribute("src");  
		                //拿到文件内容  
		                var content = $this.getFileContent($this.getRequestUrl(filePath, src));  
		                //将文本转换成节点  
		                var parent = this.parentNode;  
		                var includeNodes = $this.parseNode($this.getHtml(content));  
		                var size = includeNodes.length;  
		                for(var i = 0; i < size; i++) {  
		                    parent.insertBefore(includeNodes[0], this);  
		                }  
		                //执行文本中的额javascript  
		                $this.executeScript(content);  
		                parent.removeChild(this);  
		                //替换元素 this.parentNode.replaceChild(includeNodes[1], this);  
		            })  
		        }  
		    }  
		    window.onload = function() {  
		        new Include39485748323().replaceIncludeElements();  
		    }  
		})(window, document) 
		
		
	</script>


	<!-- jQuery UI 
    <script src="js/plugins/jquery-ui/jquery-ui.min.js"></script>-->
</body>
</html>
